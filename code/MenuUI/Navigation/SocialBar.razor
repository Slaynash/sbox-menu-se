@using System;
@using Sandbox;
@using Sandbox.UI;
@namespace Menu.Social

<root>
	<div class="left">
        
	</div>

	<div class="right">

        <div tooltip="Show Friend List" @onclick=@(() => FriendList.Toggle()) class="friends-button">
            <i>groups</i>
            <div class="count">@MenuUtility.Friends.Count(x => x.IsPlayingThisGame && x.IsFriend).ToString("n0")</div>
        </div>

        <div class="player-info">
            <div class="avatar button-simple" style="background-image: url( avatar:@Sandbox.Utility.Steam.SteamId )" onclick=@SelfPopup></div>
            <div class="name">@Sandbox.Utility.Steam.PersonaName</div>
        </div>

	</div>
</root>

@code
{
    string LocalPlayerAvatarUrl => $"avatar:{Game.SteamId}";

    [Event("friend.change")]
    public void UpdatePlayingFriendCount(Friend friend)
    {
        StateHasChanged();
    }

    void SelfPopup( PanelEvent e )
    {
        /*
        var popup = new Popup( e.Target, Popup.PositionMode.AboveLeft, 16.0f );
        popup.AddClass( "medium" );
        popup.Title = "The Party";
        popup.Icon = "cake";

        popup.Add.ButtonWithIcon("Leave The Party", "time_to_leave", null, () =>
        {
            PartyLobby.Leave();
            popup.Success();
        });
        */
    }

}
